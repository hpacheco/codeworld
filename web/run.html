<!DOCTYPE html>
<html>
<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=default,Array.prototype.find,Number.isFinite,Number.isInteger,console,console.log,document.head,performance.now"></script>

<head>
    <title>CodeWorld</title>
    <link rel="stylesheet" type="text/css" href="css/theme-variables.css">
    <link rel="stylesheet" type="text/css" href="css/runner.css">
</head>

<body style="text-align: center">
    <audio id="sound0" src="sounds/on.wav"></audio>
    <audio id="sound1" src="sounds/off.wav"></audio>
    <audio id="sound2" src="sounds/recharge.wav"></audio>
    <audio id="sound3" src="sounds/button.wav"></audio>
    <audio id="sound4" src="sounds/error.wav"></audio>
    <audio id="sound5" src="sounds/cleaningstart.wav"></audio>
    <audio id="sound6" src="sounds/cleaningend.wav"></audio>
    <canvas id="screen"></canvas>
    <img style="visibility: hidden;" id="box-turtle" src="images/box-turtle.png">
    <img style="visibility: hidden;" id="diamondback" src="images/diamondback.png">
    <img style="visibility: hidden;" id="electric" src="images/electric.png">
    <img style="visibility: hidden;" id="fuerte" src="images/fuerte.png">
    <img style="visibility: hidden;" id="groovy" src="images/groovy.png">
    <img style="visibility: hidden;" id="hydro" src="images/hydro.png">
    <img style="visibility: hidden;" id="indigo" src="images/indigo.png">
    <img style="visibility: hidden;" id="robot-turtle" src="images/robot-turtle.png">
    <img style="visibility: hidden;" id="sea-turtle" src="images/sea-turtle.png">
</body>
<script type="text/javascript" src="js/run.js"></script>
<script type="text/javascript">
    // params from the URL
    let paramList = location.search.slice(1).split('&');
    let params = {};
    for (let i = 0; i < paramList.length; i++) {
        let name = paramList[i].split('=')[0];
        let value = paramList[i].slice(name.length + 1);
        params[name] = value;
    }
    // params from the hash
    paramList = location.hash.slice(1).split('&');
    for (let i = 0; i < paramList.length; i++) {
        let name = paramList[i].split('=')[0];
        let value = paramList[i].slice(name.length + 1);
        params[name] = value;
    }

    let hash = params['hash'];
    let dhash = params['dhash'];
    let mode = params['mode'];
    // Game id is just dumped in the global JS namespace and read there by gameOf
    let gid = params['gid'];
    if (!mode) mode = 'rosy';

    let query = '?mode=' + mode;
    if (hash) query += '&hash=' + hash;
    if (dhash) query += '&dhash=' + dhash;

    let uri = 'runJS' + query;

    let loadScript = document.createElement('script');
    loadScript.setAttribute('type', 'text/javascript');
    loadScript.setAttribute('src', uri);
    document.body.appendChild(loadScript);

</script>
<script type="text/javascript" src="js/debugmode.js"></script>

</html>
